<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>How to make a balance law · ClimateMachine</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.svg" alt="ClimateMachine logo"/></a><div class="docs-package-name"><span class="docs-autofit">ClimateMachine</span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><a class="tocitem" href="../../../../Installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Experiments</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">AtmosGCM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/experiments/AtmosGCM/heldsuarez/">heldsuarez.jl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">AtmosLES</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/experiments/AtmosLES/bomex/">bomex.jl</a></li><li><a class="tocitem" href="../../../../generated/experiments/AtmosLES/dycoms/">dycoms.jl</a></li><li><a class="tocitem" href="../../../../generated/experiments/AtmosLES/risingbubble/">risingbubble.jl</a></li><li><a class="tocitem" href="../../../../generated/experiments/AtmosLES/surfacebubble/">surfacebubble.jl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">OceanBoxGCM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/experiments/OceanBoxGCM/homogeneous_box/">homogeneous_box.jl</a></li><li><a class="tocitem" href="../../../../generated/experiments/OceanBoxGCM/ocean_gyre/">ocean_gyre.jl</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Atmos/heldsuarez/">Dry Idealized GCM</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-3-1" type="checkbox"/><label class="tocitem" for="menuitem-4-3-1"><span class="docs-label">Heat</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Land/Heat/heat_equation/">Heat Equation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-4-1"><span class="docs-label">LinearSolvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Numerics/LinearSolvers/cg/">Conjugate Gradient</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-4-2"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/literate_markdown/">Notes on Literate</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">How-to-guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Contributing/CONTRIBUTING/">Home</a></li><li><span class="tocitem">Arrays</span></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Common/SurfaceFluxes/">SurfaceFluxes</a></li><li><a class="tocitem" href="../../../Common/MoistThermodynamics/">MoistThermodynamics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../../Atmos/Model/risingbubble/">Rising Bubble LES</a></li><li><a class="tocitem" href="../../../Atmos/Microphysics/">Microphysics</a></li><li><a class="tocitem" href="../../../Atmos/Model/turbulence/">Turbulence</a></li><li><a class="tocitem" href="../../../Atmos/Model/tracers/">Tracers</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Diagnostics/DiagnosticVariables/">Variables</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox" checked/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Meshes</span></li><li><input class="collapse-toggle" id="menuitem-5-8-2" type="checkbox" checked/><label class="tocitem" for="menuitem-5-8-2"><span class="docs-label">DG methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>How to make a balance law</a><ul class="internal"><li><a class="tocitem" href="#Variable-name-specification-methods-1"><span>Variable name specification methods</span></a></li><li><a class="tocitem" href="#Methods-to-compute-gradients-and-integrals-1"><span>Methods to compute gradients and integrals</span></a></li><li><a class="tocitem" href="#Methods-to-compute-fluxes-and-sources-1"><span>Methods to compute fluxes and sources</span></a></li><li><a class="tocitem" href="#Methods-to-compute-numerical-fluxes-1"><span>Methods to compute numerical fluxes</span></a></li><li><a class="tocitem" href="#Methods-to-set-initial-conditions-1"><span>Methods to set initial conditions</span></a></li><li><a class="tocitem" href="#General-Remarks-1"><span>General Remarks</span></a></li><li class="toplevel"><a class="tocitem" href="#Reference-links-1"><span>Reference links</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8-3" type="checkbox"/><label class="tocitem" for="menuitem-5-8-3"><span class="docs-label">ODE Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ODESolvers/Timestepping/">Time-integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8-4" type="checkbox"/><label class="tocitem" for="menuitem-5-8-4"><span class="docs-label">Linear Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../LinearSolvers/IterativeSolvers/">Iterative Solvers</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/">Home</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../../../APIs/Atmos/Microphysics/">Microphysics</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Common/SurfaceFluxes/">Surface Fluxes</a></li></ul></li><li><a class="tocitem" href="../../../../APIs/Arrays/Arrays/">Arrays</a></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Diagnostics/Diagnostics/">List of variables</a></li><li><a class="tocitem" href="../../../../APIs/Diagnostics/InputOutput/">Input/Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Numerics/Meshes/Mesh/">Meshes</a></li><li><a class="tocitem" href="../../../../APIs/Numerics/LinearSolvers/LinearSolvers/">LinearSolvers</a></li><li><a class="tocitem" href="../../../../APIs/Numerics/ODESolvers/ODESolvers/">ODESolvers</a></li><li><a class="tocitem" href="../../../../APIs/Numerics/DGmethods/BalanceLawOverview/">Balance Law</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Theory &amp; design philosophy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Discussions/">Home</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Discussions/Atmos/EDMFEquations/">Eddy-Diffusivity Mass-Flux (EDMF) equations</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../CodingConventions/">Coding Conventions</a></li><li><a class="tocitem" href="../../../../AcceptableUnicode/">Acceptable Unicode characters</a></li><li><a class="tocitem" href="../../../../VariableList/">ClimateMachine Variable List</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How-to-guides</a></li><li><a class="is-disabled">Numerics</a></li><li><a class="is-disabled">DG methods</a></li><li class="is-active"><a href>How to make a balance law</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>How to make a balance law</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimateMachine.jl/blob/master/docs/src/HowToGuides/Numerics/DGmethods/how_to_make_a_balance_law.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-make-a-Balance-law-1"><a class="docs-heading-anchor" href="#How-to-make-a-Balance-law-1">How to make a Balance law</a><a class="docs-heading-anchor-permalink" href="#How-to-make-a-Balance-law-1" title="Permalink"></a></h1><p>Defining the set of solved PDEs in ClimateMachine revolve around defining a <a href="HowToGuides/Numerics/DGmethods/@ref"><code>BalanceLaw</code></a>. A balance law solves equations of the form:</p><pre><code class="language-none">∂Y
-- = - ∇ • {F_{first_order}(Y) + F_{second_order}(Y, Σ) ) + S_{non_conservative}(Y, Σ)
∂t</code></pre><p>Here, <code>Y</code>, <code>Σ</code>, <code>F_{first_order}</code>, <code>F_{second_order}</code>, and <code>S_{non_conservative}</code> can be thought of column vectors<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> expressing:</p><ul><li><code>Y</code> the conservative state variables, or unknowns of the PDEs to be solved</li><li><code>Σ</code> the gradients of functions of the conservative state variables</li><li><code>F_{first-order}</code> contains all first-order fluxes (e.g. <strong>not</strong> functions of gradients of any variables)</li><li><code>F_{second-order}</code> contains all second-order and higher-order fluxes (e.g. functions of gradients of any variables)</li><li><code>S_{non_conservative}</code> non-conservative sources<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></li></ul><p>In order to alleviate users from being concerned with the burden of spatial discretization, users must provide their own implementations of the following methods, which are computed locally at each nodal point:</p><h2 id="Variable-name-specification-methods-1"><a class="docs-heading-anchor" href="#Variable-name-specification-methods-1">Variable name specification methods</a><a class="docs-heading-anchor-permalink" href="#Variable-name-specification-methods-1" title="Permalink"></a></h2><p>| <strong>Method</strong> | Necessary | Purpose | |:––-|:-|:––| | <a href="HowToGuides/Numerics/DGmethods/@ref"><code>vars_state_conservative</code></a>         | <strong>YES</strong> |  specify the names of the variables in the conservative state vector, typically mass, momentum, and various tracers. | | <a href="HowToGuides/Numerics/DGmethods/@ref"><code>vars_state_auxiliary</code></a>           | <strong>YES</strong> |  specify the names of any variables required for the balance law that aren&#39;t related to derivatives of the state variables (e.g. spatial coordinates or various integrals) or those needed to solve expensive auxiliary equations (e.g., temperature via a non-linear equation solve)     | | <a href="HowToGuides/Numerics/DGmethods/@ref"><code>vars_state_gradient</code></a>         | <strong>YES</strong> |  specify the names of the gradients of functions of the conservative state variables. used to represent values before <strong>and</strong> after differentiation | | <a href="HowToGuides/Numerics/DGmethods/@ref"><code>vars_state_gradient_flux</code></a>         | <strong>YES</strong> |  specify the names of the gradient fluxes necessary to impose Neumann boundary conditions. typically the product of a diffusivity tensor with a gradient state variable, potentially equivalent to the second-order flux for a conservative state variable | | <a href="HowToGuides/Numerics/DGmethods/@ref"><code>vars_integrals</code></a>         | <strong>NO</strong> |  specify the names of any one-dimensional vertical integrals from <strong>bottom to top</strong> of the domain required for the balance law. used to represent both the integrand <strong>and</strong> the resulting indefinite integral | | <a href="HowToGuides/Numerics/DGmethods/@ref"><code>vars_reverse_integrals</code></a>         | <strong>NO</strong> |  specify the names of any one-dimensional vertical integral from <strong>top to bottom</strong> of the domain required for the balance law. each variable here must also exist in <code>vars_integrals</code> since the reverse integral kernels use subtraction to reverse the integral instead of performing a new integral. use to represent the value before <strong>and</strong> after reversing direction |</p><h2 id="Methods-to-compute-gradients-and-integrals-1"><a class="docs-heading-anchor" href="#Methods-to-compute-gradients-and-integrals-1">Methods to compute gradients and integrals</a><a class="docs-heading-anchor-permalink" href="#Methods-to-compute-gradients-and-integrals-1" title="Permalink"></a></h2><table><tr><th style="text-align: left"><strong>Method</strong></th><th style="text-align: left">Purpose</th></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>compute_gradient_argument!</code></a></td><td style="text-align: left">specify how to compute the arguments to the gradients. can be functions of conservative state  and auxiliary variables.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>compute_gradient_flux!</code></a></td><td style="text-align: left">specify how to compute gradient fluxes. can be a functions of the gradient state, the conservative state, and auxiliary variables.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>integral_load_auxiliary_state!</code></a></td><td style="text-align: left">specify how to compute integrands. can be functions of the conservative state and auxiliary variables.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>integral_set_auxiliary_state!</code></a></td><td style="text-align: left">specify which auxiliary variables are used to store the output of the integrals.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>reverse_integral_load_auxiliary_state!</code></a></td><td style="text-align: left">specify auxiliary variables need their integrals reversed.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>reverse_integral_set_auxiliary_state!</code></a></td><td style="text-align: left">specify which auxiliary variables are used to store the output of the reversed integrals.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>update_auxiliary_state!</code></a></td><td style="text-align: left">perform any updates to the auxiliary variables needed at the beginning of each time-step. Can be used to solve non-linear equations, calculate integrals, and apply filters.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>update_auxiliary_state_gradient!</code></a></td><td style="text-align: left">same as above, but after computing gradients and gradient fluxes in case these variables are needed during the update.</td></tr></table><h2 id="Methods-to-compute-fluxes-and-sources-1"><a class="docs-heading-anchor" href="#Methods-to-compute-fluxes-and-sources-1">Methods to compute fluxes and sources</a><a class="docs-heading-anchor-permalink" href="#Methods-to-compute-fluxes-and-sources-1" title="Permalink"></a></h2><table><tr><th style="text-align: left"><strong>Method</strong></th><th style="text-align: left">Purpose</th></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>flux_first_order!</code></a></td><td style="text-align: left">specify <code>F_{first_order}</code> for each conservative state variable. can be functions of the conservative state and auxiliary variables.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>flux_second_order!</code></a></td><td style="text-align: left">specify <code>F_{second_order}</code> for each conservative state variable. can be functions of the conservative state, gradient flux state, and auxiliary variables.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>source!</code></a></td><td style="text-align: left">specify <code>S_{non_conservative}</code>  for each conservative state variable. can be functions of the conservative state, gradient flux state, and auxiliary variables.</td></tr></table><h2 id="Methods-to-compute-numerical-fluxes-1"><a class="docs-heading-anchor" href="#Methods-to-compute-numerical-fluxes-1">Methods to compute numerical fluxes</a><a class="docs-heading-anchor-permalink" href="#Methods-to-compute-numerical-fluxes-1" title="Permalink"></a></h2><table><tr><th style="text-align: left"><strong>Method</strong></th><th style="text-align: left">Purpose</th></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>wavespeed</code></a></td><td style="text-align: left">specify how to compute the local wavespeed if using the <code>RusanovNumericalFlux</code>.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>boundary_state!</code></a></td><td style="text-align: left">define exterior nodal values of the conservative state and gradient flux state used to compute the numerical boundary fluxes.</td></tr></table><h2 id="Methods-to-set-initial-conditions-1"><a class="docs-heading-anchor" href="#Methods-to-set-initial-conditions-1">Methods to set initial conditions</a><a class="docs-heading-anchor-permalink" href="#Methods-to-set-initial-conditions-1" title="Permalink"></a></h2><table><tr><th style="text-align: left"><strong>Method</strong></th><th style="text-align: left">Purpose</th></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>init_state_conservative!</code></a></td><td style="text-align: left">provide initial values for the conservative state as a function of time and space.</td></tr><tr><td style="text-align: left"><a href="HowToGuides/Numerics/DGmethods/@ref"><code>init_state_auxiliary!</code></a></td><td style="text-align: left">provide initial values for the auxiliary variables as a function of the geometry.</td></tr></table><h2 id="General-Remarks-1"><a class="docs-heading-anchor" href="#General-Remarks-1">General Remarks</a><a class="docs-heading-anchor-permalink" href="#General-Remarks-1" title="Permalink"></a></h2><p>While <code>Y</code> can be thought of a column vector (each <em>row</em> of which corresponds to each state variable and its prognostic equation), the <em>second</em> function argument inside these methods behave as dictionaries, for example:</p><pre><code class="language-none">struct MyModel &lt;: BalanceLaw end

function vars_state_conservative(m::MyModel, FT)
    @vars begin
        ρ::FT
        T::FT
    end
end

function source!(m::MyModel, source::Vars, args...)
    source.ρ = 1 # adds a source of 1 to RHS of ρ equation
    source.T = 1 # adds a source of 1 to RHS of T equation
end</code></pre><p>All equations are marched simultaneously in time.</p><h1 id="Reference-links-1"><a class="docs-heading-anchor" href="#Reference-links-1">Reference links</a><a class="docs-heading-anchor-permalink" href="#Reference-links-1" title="Permalink"></a></h1><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://en.wikipedia.org/wiki/Row_and_column_vectors">Column Vectors</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Note that using non-conservative sources should be a final resort, as this can leak conservation of the unknowns and lead to numerical instabilities. It is recommended to use either <code>F_{diffusive}</code> or <code>F_{non_diffusive}</code>, as these fluxes are communicated across elements<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup></li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>MPI communication occurs only across elements, not within each element, where there may be many [Gauss-Lobatto]<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup> points</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a><a href="https://en.wikipedia.org/wiki/Gaussian_quadrature#Gauss%E2%80%93Lobatto_rules">Gauss-Lobatto</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../Diagnostics/DiagnosticVariables/">« Variables</a><a class="docs-footer-nextpage" href="../../ODESolvers/Timestepping/">Time-integration »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 13 May 2020 15:51">Wednesday 13 May 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
