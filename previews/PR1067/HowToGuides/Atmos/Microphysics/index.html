<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Microphysics · ClimateMachine</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="ClimateMachine logo"/></a><div class="docs-package-name"><span class="docs-autofit">ClimateMachine</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../Installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Experiments</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">AtmosGCM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/experiments/AtmosGCM/heldsuarez/">heldsuarez.jl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">AtmosLES</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/experiments/AtmosLES/bomex/">bomex.jl</a></li><li><a class="tocitem" href="../../../generated/experiments/AtmosLES/dycoms/">dycoms.jl</a></li><li><a class="tocitem" href="../../../generated/experiments/AtmosLES/risingbubble/">risingbubble.jl</a></li><li><a class="tocitem" href="../../../generated/experiments/AtmosLES/surfacebubble/">surfacebubble.jl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">OceanBoxGCM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/experiments/OceanBoxGCM/homogeneous_box/">homogeneous_box.jl</a></li><li><a class="tocitem" href="../../../generated/experiments/OceanBoxGCM/ocean_gyre/">ocean_gyre.jl</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Atmos/heldsuarez/">Dry Idealized GCM</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-3-1" type="checkbox"/><label class="tocitem" for="menuitem-4-3-1"><span class="docs-label">LinearSolvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/LinearSolvers/cg/">Conjugate Gradient</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3-2" type="checkbox"/><label class="tocitem" for="menuitem-4-3-2"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/literate_markdown/">Notes on Literate</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">How-to-guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Contributing/CONTRIBUTING/">Home</a></li><li><span class="tocitem">Arrays</span></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Common/SurfaceFluxes/">SurfaceFluxes</a></li><li><a class="tocitem" href="../../Common/MoistThermodynamics/">MoistThermodynamics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox" checked/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../Model/risingbubble/">Rising Bubble LES</a></li><li class="is-active"><a class="tocitem" href>Microphysics</a><ul class="internal"><li><a class="tocitem" href="#Assumed-particle-size-relationships-1"><span>Assumed particle size relationships</span></a></li><li><a class="tocitem" href="#Assumed-particle-size-distributions-1"><span>Assumed particle size distributions</span></a></li><li><a class="tocitem" href="#Parameterized-processes-1"><span>Parameterized processes</span></a></li></ul></li><li><a class="tocitem" href="../Model/turbulence/">Turbulence</a></li><li><a class="tocitem" href="../Model/tracers/">Tracers</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Diagnostics/DiagnosticVariables/">Variables</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox"/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Meshes</span></li><li><input class="collapse-toggle" id="menuitem-5-8-2" type="checkbox"/><label class="tocitem" for="menuitem-5-8-2"><span class="docs-label">DG methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Numerics/DGmethods/how_to_make_a_balance_law/">How to make a balance law</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8-3" type="checkbox"/><label class="tocitem" for="menuitem-5-8-3"><span class="docs-label">ODE Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Numerics/ODESolvers/Timestepping/">Time-integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8-4" type="checkbox"/><label class="tocitem" for="menuitem-5-8-4"><span class="docs-label">Linear Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Numerics/LinearSolvers/IterativeSolvers/">Iterative Solvers</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/">Home</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../../APIs/Atmos/Microphysics/">Microphysics</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Common/SurfaceFluxes/">Surface Fluxes</a></li></ul></li><li><a class="tocitem" href="../../../APIs/Arrays/Arrays/">Arrays</a></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Diagnostics/Diagnostics/">List of variables</a></li><li><a class="tocitem" href="../../../APIs/Diagnostics/InputOutput/">Input/Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Numerics/Meshes/Mesh/">Meshes</a></li><li><a class="tocitem" href="../../../APIs/Numerics/LinearSolvers/LinearSolvers/">LinearSolvers</a></li><li><a class="tocitem" href="../../../APIs/Numerics/ODESolvers/ODESolvers/">ODESolvers</a></li><li><a class="tocitem" href="../../../APIs/Numerics/DGmethods/BalanceLawOverview/">Balance Law</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Theory &amp; design philosophy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Discussions/">Home</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Discussions/Atmos/EDMFEquations/">Eddy-Diffusivity Mass-Flux (EDMF) equations</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../CodingConventions/">Coding Conventions</a></li><li><a class="tocitem" href="../../../AcceptableUnicode/">Acceptable Unicode characters</a></li><li><a class="tocitem" href="../../../VariableList/">ClimateMachine Variable List</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How-to-guides</a></li><li><a class="is-disabled">Atmos</a></li><li class="is-active"><a href>Microphysics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Microphysics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimateMachine.jl/blob/master/docs/src/HowToGuides/Atmos/Microphysics.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Microphysics-1"><a class="docs-heading-anchor" href="#Microphysics-1">Microphysics</a><a class="docs-heading-anchor-permalink" href="#Microphysics-1" title="Permalink"></a></h1><p>The <code>Microphysics.jl</code> module describes a 1-moment bulk parameterization of cloud microphysical processes. The module is based on the ideas of <a href="https://www.sciencedirect.com/science/article/pii/016980959400090Z">Kessler_1995</a>, <a href="https://journals.ametsoc.org/doi/full/10.1175/1520-0469%281998%29055%3C3283%3ATCRMOL%3E2.0.CO%3B2 ">Grabowski_1998</a> and <a href="https://journals.ametsoc.org/doi/10.1175/MWR-D-14-00319.1">Kaul_et_al_2015</a></p><p>The cloud microphysics variables are expressed as specific humidities:</p><ul><li><code>q_tot</code> - total water specific humidity,</li><li><code>q_vap</code> - water vapor specific humidity,</li><li><code>q_liq</code> - cloud water specific humidity,</li><li><code>q_ice</code> - cloud ice specific humidity,</li><li><code>q_rai</code> - rain specific humidity,</li><li><code>q_sno</code> - snow specific humidity.</li></ul><h2 id="Assumed-particle-size-relationships-1"><a class="docs-heading-anchor" href="#Assumed-particle-size-relationships-1">Assumed particle size relationships</a><a class="docs-heading-anchor-permalink" href="#Assumed-particle-size-relationships-1" title="Permalink"></a></h2><p>Particles are assumed to follow the mass(radius), cross section(radius), terminal velocity(radius) relationships defined as power laws. The coefficients are defined in <code>MicrophysicsParameters</code> module and are shown in the Table below. For rain and ice they correspond to spherical liquid water drops and ice particles, respectively. There is no assumed particle shape for snow and the relationships are based on empirical values from <a href="https://journals.ametsoc.org/doi/full/10.1175/1520-0469%281998%29055%3C3283%3ATCRMOL%3E2.0.CO%3B2 ">Grabowski_1998</a>.</p><div>\[m(r) = \alpha r^{\beta}\]</div><div>\[a(r) = \gamma r^{\delta}\]</div><div>\[v_{term}(r) = \zeta r^{\eta}\]</div><p>where:</p><ul><li><span>$r$</span> is the particle radius,</li><li><span>$\alpha, \, \beta, \, \gamma, \, \delta, \, \zeta, \, \eta \,$</span> are the coefficients.</li></ul><p>These coefficients, smiliarliy to all other microphysics parameters, are not hardcoded in the final microphysics parameterizations. The goal is to allow easy flexibility when calibrating the microphysics parameters. With that said, the assumption about the shape of the particles is used twice when deriving the microphysics formulae:</p><ul><li>The mass transfer equation (\ref{eq:mass_rate}) used in snow autoconversion, rain evaporation, snow sublimation and snow melt rates is derived assuming spherical particle shapes. To correct for non-spherical shape it should be multiplied by a function of the particle aspect ratio.</li><li>The geometric collision kernel used for deriving rain-snow accretion rate assumes that both colliding particles are spherical. It does not take into account the reduced cross-section of snow particles that is used when modeling snow - cloud water and snow - cloud ice accretion.</li></ul><table><tr><th style="text-align: right">symbol</th><th style="text-align: right">definition</th><th style="text-align: right">units</th><th style="text-align: right">default value</th></tr><tr><td style="text-align: right"><span>$\alpha^{rai}$</span></td><td style="text-align: right">coefficient in mass(radius) for rain</td><td style="text-align: right"><span>$\frac{kg}{m^3}$</span></td><td style="text-align: right"><span>$\frac{4}{3} \, \pi \, \rho_{water}$</span></td></tr><tr><td style="text-align: right"><span>$\beta^{rai}$</span></td><td style="text-align: right">exponent in mass(radius) for rain</td><td style="text-align: right">-</td><td style="text-align: right"><span>$3$</span></td></tr><tr><td style="text-align: right"><span>$\gamma^{rai}$</span></td><td style="text-align: right">coefficient in cross section(radius) for rain</td><td style="text-align: right">-</td><td style="text-align: right"><span>$\pi$</span></td></tr><tr><td style="text-align: right"><span>$\delta^{rai}$</span></td><td style="text-align: right">exponent in cross section(radius) for rain</td><td style="text-align: right">-</td><td style="text-align: right"><span>$2$</span></td></tr><tr><td style="text-align: right"><span>$\eta^{rai}$</span></td><td style="text-align: right">exponent in velocity(radius) for rain</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.5$</span></td></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><span>$\alpha^{ice}$</span></td><td style="text-align: right">coefficient in mass(radius) for ice</td><td style="text-align: right"><span>$\frac{kg}{m^3}$</span></td><td style="text-align: right"><span>$\frac{4}{3} \, \pi \, \rho_{ice}$</span></td></tr><tr><td style="text-align: right"><span>$\beta^{ice}$</span></td><td style="text-align: right">exponent in mass(radius) for ice</td><td style="text-align: right">-</td><td style="text-align: right"><span>$3$</span></td></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><span>$\alpha^{sno}$</span></td><td style="text-align: right">coefficient in mass(radius) for snow</td><td style="text-align: right"><span>$\frac{kg}{m^2}$</span></td><td style="text-align: right"><span>$0.1$</span></td></tr><tr><td style="text-align: right"><span>$\beta^{sno}$</span></td><td style="text-align: right">exponent in mass(radius) for snow</td><td style="text-align: right">-</td><td style="text-align: right"><span>$2$</span></td></tr><tr><td style="text-align: right"><span>$\gamma^{sno}$</span></td><td style="text-align: right">coefficient in cross section(radius) for snow</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.3 \, \pi$</span></td></tr><tr><td style="text-align: right"><span>$\delta^{sno}$</span></td><td style="text-align: right">exponent in cross section(radius) for snow</td><td style="text-align: right">-</td><td style="text-align: right"><span>$2$</span></td></tr><tr><td style="text-align: right"><span>$\zeta^{sno}$</span></td><td style="text-align: right">coefficient in velocity(radius) for snow</td><td style="text-align: right"><span>$\frac{m^{3/4}}{s}$</span></td><td style="text-align: right"><span>$2^{9/4}$</span></td></tr><tr><td style="text-align: right"><span>$\eta^{sno}$</span></td><td style="text-align: right">exponent in velocity(radius) for snow</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.25$</span></td></tr></table><p>where:</p><ul><li><span>$\rho_{water}$</span> is the density of water,</li><li><span>$\rho_{ice}$</span> is the density of ice.</li></ul><p><span>$\gamma^{sno}$</span> corresponds to parameter <span>$\alpha$</span> in eq(16b) in from <a href="https://journals.ametsoc.org/doi/full/10.1175/1520-0469%281998%29055%3C3283%3ATCRMOL%3E2.0.CO%3B2 ">Grabowski_1998</a>.</p><p>The terminal velocity of an individual rain drop is defined by the balance between the gravitational acceleration (taking into account the density difference between water and air) and the drag force. Therefore the <span>$\zeta^{rai}$</span> is defined as</p><div>\[\begin{equation}
\zeta^{rai} = \left(\frac{8}{3 \, C_{drag}} \left( \frac{\rho_{water}}{\rho} -1 \right) \right)^{1/2} (g)^{1/2}
\label{eq:vdrop}
\end{equation}\]</div><p>where:</p><ul><li><span>$g$</span> is the gravitational acceleration,</li><li><span>$C_{drag}$</span> is the drag coefficient,</li><li><span>$\rho$</span> is the density of air.<br/></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It would be great to replace the above simple power laws with more accurate relationships. For example: <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0469%282002%29059%3C1872%3ATVODAC%3E2.0.CO%3B2">Khvorostyanov_and_Curry_2002</a></p></div></div><h2 id="Assumed-particle-size-distributions-1"><a class="docs-heading-anchor" href="#Assumed-particle-size-distributions-1">Assumed particle size distributions</a><a class="docs-heading-anchor-permalink" href="#Assumed-particle-size-distributions-1" title="Permalink"></a></h2><p>The particle size distributions are assumed to follow Marshall-Palmer distribution <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0469%281948%29005%3C0165%3ATDORWS%3E2.0.CO%3B2">Marshall_and_Palmer_1948</a>  eq. 1:</p><div>\[\begin{equation}
n(r) = n_{0} exp\left(- \lambda \, r \right)
\end{equation}\]</div><p>where:</p><ul><li><span>$n_{0}$</span> and <span>$\lambda$</span> are the Marshall-Palmer distribution parameters.</li></ul><p>The <span>$n_0$</span> for rain and ice is assumed constant. The <span>$n_0$</span> for snow is defined as</p><div>\[\begin{equation}
n_0^{sno} = \mu^{sno} (\rho q_{sno})^{\nu^{sno}}
\end{equation}\]</div><p>where:</p><ul><li><span>$\mu^{sno}$</span> and <span>$\nu^{sno}$</span> are the coefficients</li></ul><p>The coefficients are defined in <code>MicrophysicsParameters</code> module and are shown in the Table below.</p><table><tr><th style="text-align: right">symbol</th><th style="text-align: right">definition</th><th style="text-align: right">units</th><th style="text-align: right">default value</th></tr><tr><td style="text-align: right"><span>$n_{0}^{rai}$</span></td><td style="text-align: right">rain drop size distribution parameter</td><td style="text-align: right"><span>$\frac{1}{m^4}$</span></td><td style="text-align: right"><span>$16 \cdot 10^6$</span></td></tr><tr><td style="text-align: right"><span>$n_{0}^{ice}$</span></td><td style="text-align: right">cloud ice size distribution parameter</td><td style="text-align: right"><span>$\frac{1}{m^4}$</span></td><td style="text-align: right"><span>$2 \cdot 10^7$</span></td></tr><tr><td style="text-align: right"><span>$\mu^{sno}$</span></td><td style="text-align: right">snow size distribution parameter coefficient</td><td style="text-align: right"><span>$?$</span></td><td style="text-align: right"><span>$4.36 \cdot 10^9$</span></td></tr><tr><td style="text-align: right"><span>$\nu^{sno}$</span></td><td style="text-align: right">snow size distribution parameter exponent</td><td style="text-align: right"><span>$?$</span></td><td style="text-align: right"><span>$0.63$</span></td></tr></table><p><span>$n_{0}^{rai}$</span> is based on the original <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0469%281948%29005%3C0165%3ATDORWS%3E2.0.CO%3B2">Marshall_and_Palmer_1948</a> paper. The rest of the parameters is taken from <a href="https://journals.ametsoc.org/doi/10.1175/MWR-D-14-00319.1">Kaul_et_al_2015</a></p><p>The <span>$\lambda$</span> parameter is defined as</p><div>\[\begin{equation}
\lambda = \left(\frac{\alpha \, n_0 \, \Gamma(\beta + 1)}{\rho \, q}\right)^{\frac{1}{\beta + 1}}
\end{equation}\]</div><p>where:</p><ul><li><span>$q$</span> is rain, snow or ice specific humidity</li><li><span>$\alpha$</span>, <span>$\beta$</span> and <span>$n_0$</span> are the corresponding mass-radius and size distribution parameters<br/></li><li><span>$\Gamma()$</span> is the gamma function</li></ul><p>The cloud-ice size distribution is only used when computing snow autoconversion rate. In the derivation of different accretion rates the cloud ice, similar to cloud water, is treated as continuous.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li><p>Do we want to keep the <span>$n_0$</span> for rain constant and <span>$n_0$</span> for snow empirical?</p></li><li><p>Do we want to test different size distributions?</p></li></ul></div></div><h2 id="Parameterized-processes-1"><a class="docs-heading-anchor" href="#Parameterized-processes-1">Parameterized processes</a><a class="docs-heading-anchor-permalink" href="#Parameterized-processes-1" title="Permalink"></a></h2><p>Parameterized processes include:</p><ul><li>diffusion of water vapour on cloud droplets and cloud ice crystals modeled as a relaxation to equilibrium</li><li>autoconversion of rain and snow,</li><li>accretion,</li><li>evaporation of rain water, sublimation and melting of snow</li><li>sedimentation of rain and snow with mass weighted average terminal velocity (Water vapour, cloud water and cloud ice are part of the working fluid and do not sediment.)</li></ul><p>Parameters used in the parameterization are defined in <code>MicrophysicsParameters</code> module. They consist of:</p><table><tr><th style="text-align: right">symbol</th><th style="text-align: right">definition</th><th style="text-align: right">units</th><th style="text-align: right">default value</th></tr><tr><td style="text-align: right"><span>$C_{drag}$</span></td><td style="text-align: right">rain drop drag coefficient</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.55$</span></td></tr><tr><td style="text-align: right"><span>$\tau_{cond\_evap}$</span></td><td style="text-align: right">cloud water condensation/evaporation timescale</td><td style="text-align: right"><span>$s$</span></td><td style="text-align: right"><span>$10$</span></td></tr><tr><td style="text-align: right"><span>$\tau_{sub\_resub}$</span></td><td style="text-align: right">cloud ice condensation/evaporation timescale</td><td style="text-align: right"><span>$s$</span></td><td style="text-align: right"><span>$10$</span></td></tr><tr><td style="text-align: right"><span>$\tau_{acnv}$</span></td><td style="text-align: right">cloud to rain water autoconversion timescale</td><td style="text-align: right"><span>$s$</span></td><td style="text-align: right"><span>$10^3$</span></td></tr><tr><td style="text-align: right"><span>$q_{liq\_threshold}$</span></td><td style="text-align: right">cloud to rain water autoconversion threshold</td><td style="text-align: right">-</td><td style="text-align: right"><span>$5 \cdot 10^{-4}$</span></td></tr><tr><td style="text-align: right"><span>$r_{is}$</span></td><td style="text-align: right">threshold particle radius between ice and snow</td><td style="text-align: right"><span>$m$</span></td><td style="text-align: right"><span>$62.5 \cdot 10^{-6}$</span></td></tr><tr><td style="text-align: right"><span>$E_{lr}$</span></td><td style="text-align: right">collision efficiency between rain drops and cloud droplets</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.8$</span></td></tr><tr><td style="text-align: right"><span>$E_{ls}$</span></td><td style="text-align: right">collision efficiency between snow and cloud droplets</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.1$</span></td></tr><tr><td style="text-align: right"><span>$E_{ir}$</span></td><td style="text-align: right">collision efficiency between rain drops and cloud ice</td><td style="text-align: right">-</td><td style="text-align: right"><span>$1$</span></td></tr><tr><td style="text-align: right"><span>$E_{is}$</span></td><td style="text-align: right">collision efficiency between snow and cloud ice</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.1$</span></td></tr><tr><td style="text-align: right"><span>$E_{rs}$</span></td><td style="text-align: right">collision efficiency between rain drops and snow</td><td style="text-align: right">-</td><td style="text-align: right"><span>$1$</span></td></tr><tr><td style="text-align: right"><span>$a_{vent}^{rai}, b_{vent}^{rai}$</span></td><td style="text-align: right">rain drop ventilation factor coefficients</td><td style="text-align: right">-</td><td style="text-align: right"><span>$1.5 \;$</span>,<span>$\; 0.53$</span></td></tr><tr><td style="text-align: right"><span>$a_{vent}^{sno}, b_{vent}^{sno}$</span></td><td style="text-align: right">snow ventilation factor coefficients</td><td style="text-align: right">-</td><td style="text-align: right"><span>$0.65 \;$</span>,<span>$\; 0.44$</span></td></tr><tr><td style="text-align: right"><span>$K_{therm}$</span></td><td style="text-align: right">thermal conductivity of air</td><td style="text-align: right"><span>$\frac{J}{m \; s \; K}$</span></td><td style="text-align: right"><span>$2.4 \cdot 10^{-2}$</span></td></tr><tr><td style="text-align: right"><span>$\nu_{air}$</span></td><td style="text-align: right">kinematic viscosity of air</td><td style="text-align: right"><span>$\frac{m^2}{s}$</span></td><td style="text-align: right"><span>$1.6 \cdot 10^{-5}$</span></td></tr><tr><td style="text-align: right"><span>$D_{vapor}$</span></td><td style="text-align: right">diffusivity of water vapor</td><td style="text-align: right"><span>$\frac{m^2}{s}$</span></td><td style="text-align: right"><span>$2.26 \cdot 10^{-5}$</span></td></tr></table><p>The default value of <span>$C_{drag}$</span> for rain is chosen such that the resulting mass averaged terminal velocity is close to the empirical terminal velocity formulation in <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0493%281996%29124%3C0487%3ATTLSLM%3E2.0.CO%3B2">Smolarkiewicz_and_Grabowski_1996</a>. The default values of <span>$a_{vent}^{rai}, b_{vent}^{rai}$</span> are chosen so that at <span>$q_{tot} = 15 g/kg$</span> and <span>$T=288K$</span> the resulting rain evaporation rate is close to the empirical rain evaporation rate from <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0493%281996%29124%3C0487%3ATTLSLM%3E2.0.CO%3B2">Smolarkiewicz_and_Grabowski_1996</a>. The default values of <span>$a_{vent}^{sno}, b_{vent}^{sno}$</span> are from <a href="https://journals.ametsoc.org/doi/10.1175/MWR-D-14-00319.1">Kaul_et_al_2015</a>. The default values of <span>$\tau_{acnv}$</span> and <span>$q_{liq\_threshold}$</span> are based on <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0493%281996%29124%3C0487%3ATTLSLM%3E2.0.CO%3B2">Smolarkiewicz_and_Grabowski_1996</a>. The <span>$r_{is}$</span> threshold is taken from <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0469%281995%29052%3C4344%3APOICCP%3E2.0.CO%3B2">Harrington_1995</a>. The <span>$E_{lr}$</span> is taken from eq(16a) in <a href="https://journals.ametsoc.org/doi/full/10.1175/1520-0469%281998%29055%3C3283%3ATCRMOL%3E2.0.CO%3B2 ">Grabowski_1998</a>. The <span>$E_{is}$</span> and <span>$E_{rs}$</span> are taken from <a href="https://journals.ametsoc.org/doi/10.1175/2008JCLI2105.1">Morrison_and_Gettelman_2008</a> The <span>$E_{ir}$</span> is taken from <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0469%281984%29041%3C2949%3ATMAMSA%3E2.0.CO%3B2">Rutledge_and_Hobbs_1984</a>. The <span>$E_{ls}$</span> is taken from <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0469%281983%29040%3C1185%3ATMAMSA%3E2.0.CO%3B2">Rutledge_and_Hobbs_1983</a>.</p><h3 id="Ventilation-factor-1"><a class="docs-heading-anchor" href="#Ventilation-factor-1">Ventilation factor</a><a class="docs-heading-anchor-permalink" href="#Ventilation-factor-1" title="Permalink"></a></h3><p>Ventilation factor parametrizes the increase in the mass and heat exchange for falling particles. Following <a href="https://link.springer.com/article/10.1007/s00703-005-0112-4">Seifert_and_Beheng_2006</a> eq. 24 the ventilation factor is defined as:</p><div>\[\begin{equation}
F(r) = a_{vent} + b_{vent}  N_{Sc}^{1/3} N_{Re}(r)^{1/2}
\label{eq:ventil_factor}
\end{equation}\]</div><p>where:</p><ul><li><span>$a_{vent}$</span>, <span>$b_{vent}$</span> are coefficients,</li><li><span>$N_{Sc}$</span> is the Schmidt number,</li><li><span>$N_{Re}$</span> is the Reynolds number of a falling particle.</li></ul><p>The Schmidt number is assumed constant:</p><div>\[N_{Sc} = \frac{\nu_{air}}{D_{vapor}}\]</div><p>where:</p><ul><li><span>$\nu_{air}$</span> is the kinematic viscosity of air,</li><li><span>$D_{vapor}$</span> is the diffusivity of water.</li></ul><p>The Reynolds number of a spherical drop is defined as:</p><div>\[N_{Re} = \frac{2 \, r \, v_{term}(r)}{\nu_{air}}\]</div><p>Applying the terminal velocity(radius) relationship results in</p><div>\[\begin{equation}
F(r) = a_{vent} +
       b_{vent} \, \left(\frac{\nu_{air}}{D_{vapor}}\right)^{\frac{1}{3}} \,
       \left(\frac{2\zeta}{\nu_{air}}\right)^{\frac{1}{2}} r^{\frac{\eta + 1}{2}}
\label{eq:vent_factor}
\end{equation}\]</div><h3 id="Terminal-velocity-1"><a class="docs-heading-anchor" href="#Terminal-velocity-1">Terminal velocity</a><a class="docs-heading-anchor-permalink" href="#Terminal-velocity-1" title="Permalink"></a></h3><p>The mass weighted terminal velocity <span>$v_t$</span> is defined following <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0493%281971%29099%3C0895%3ANSOTLC%3E2.3.CO%3B2">Ogura_and_Takahashi_1971</a>:</p><div>\[\begin{equation}
v_t = \frac{\int_0^\infty n(r) \, m(r) \, v_{term}(r) \, dr}{\int_0^\infty n(r) \, m(r) \, dr}
\label{eq:vt}
\end{equation}\]</div><p>Integrating over the assumed Marshall-Palmer distribution and using the mass-radius and velocity-radius relationships results in</p><div>\[\begin{equation}
v_t = \zeta \lambda^{-\eta} \frac{\Gamma(\eta + \beta + 1)}{\Gamma(\beta + 1)}
\end{equation}\]</div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Assuming a constant drag coefficient is an approximation and it should be size and flow dependent, see <a href="https://www.grc.nasa.gov/www/K-12/airplane/dragsphere.html">drag_coefficient</a>. In general we should implement these terminal velocity parameterizations: <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0469%282002%29059%3C1872%3ATVODAC%3E2.0.CO%3B2">Khvorostyanov_and_Curry_2002</a></p></div></div><h3 id="Cloud-water-condensation/evaporation-1"><a class="docs-heading-anchor" href="#Cloud-water-condensation/evaporation-1">Cloud water condensation/evaporation</a><a class="docs-heading-anchor-permalink" href="#Cloud-water-condensation/evaporation-1" title="Permalink"></a></h3><p>Condensation and evaporation of cloud water is parameterized as a relaxation to equilibrium value at the current time step.</p><div>\[\begin{equation}
  \left. \frac{d \, q_{liq}}{dt} \right|_{cond, evap} = \frac{q^{eq}_{liq} - q_{liq}}{\tau_{cond\_evap}}
\end{equation}\]</div><p>where:</p><ul><li><span>$q^{eq}_{liq}$</span> - liquid water specific humidity in equilibrium,</li><li><span>$q_{liq}$</span> - liquid water specific humidity,</li><li><span>$\tau_{cond\_evap}$</span> - relaxation timescale (parameter in <code>MicrophysicsParameters</code> module).</li></ul><h3 id="Cloud-ice-sublimation/resublimation-1"><a class="docs-heading-anchor" href="#Cloud-ice-sublimation/resublimation-1">Cloud ice sublimation/resublimation</a><a class="docs-heading-anchor-permalink" href="#Cloud-ice-sublimation/resublimation-1" title="Permalink"></a></h3><p>Sublimation and resublimation of cloud ice is parameterized as a relaxation to equilibrium value at the current time step.</p><div>\[\begin{equation}
  \left. \frac{d \, q_{ice}}{dt} \right|_{sub, resub} = \frac{q^{eq}_{ice} - q_{ice}}{\tau_{sub\_resub}}
\end{equation}\]</div><p>where:</p><ul><li><span>$q^{eq}_{ice}$</span> - ice specific humidity in equilibrium,</li><li><span>$q_{ice}$</span> - ice specific humidity,</li><li><span>$\tau_{sub\_resub}$</span> - relaxation timescale (parameter in <code>MicrophysicsParameters</code> module).</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Both <span>$\tau_{cond\_evap}$</span> and <span>$\tau_{sub\_resub}$</span> are assumed constant here. It would be great to make the relaxation time a function of available condensation nuclei, turbulence intensity, etc. See works by <a href="https://www.mtu.edu/physics/department/faculty/shaw/">prof Raymond Shaw</a> for hints.</p></div></div><h3 id="Rain-autoconversion-1"><a class="docs-heading-anchor" href="#Rain-autoconversion-1">Rain autoconversion</a><a class="docs-heading-anchor-permalink" href="#Rain-autoconversion-1" title="Permalink"></a></h3><p>Rain autoconversion defines the rate of conversion form cloud to rain water due to collisions between cloud droplets. It is parameterized following <a href="https://www.sciencedirect.com/science/article/pii/016980959400090Z">Kessler_1995</a>:</p><div>\[\begin{equation}
  \left. \frac{d \, q_{rai}}{dt} \right|_{acnv} = \frac{max(0, q_{liq} - q_{liq\_threshold})}{\tau_{acnv}}
\end{equation}\]</div><p>where:</p><ul><li><span>$q_{liq}$</span> - liquid water specific humidity,</li><li><span>$\tau_{acnv}$</span> - timescale (parameter in <code>MicrophysicsParameters</code> module),</li><li><span>$q_{liq\_threshold}$</span> - autoconversion (parameter in <code>MicrophysicsParameters</code> module).</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This is the simplest possible autoconversion parameterization. It would be great to implement others and test the impact on precipitation. See for example <a href="https://journals.ametsoc.org/doi/full/10.1175/JAS3530.1">Wood_2005</a> Table 1 for other simple choices.</p></div></div><h3 id="Snow-autoconversion-1"><a class="docs-heading-anchor" href="#Snow-autoconversion-1">Snow autoconversion</a><a class="docs-heading-anchor-permalink" href="#Snow-autoconversion-1" title="Permalink"></a></h3><p>Snow autoconversion defines the rate of conversion form cloud ice to snow due the growth of cloud ice by sublimation (deposition of water vapor). It is defined as the change of mass of cloud ice for cloud ice particles larger than threshold <span>$r_{is}$</span>. See <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0469%281995%29052%3C4344%3APOICCP%3E2.0.CO%3B2">Harrington_1995</a> for derivation.</p><div>\[\begin{equation}
  \left. \frac{d \, q_{sno}}{dt} \right|_{acnv} =
  \frac{1}{\rho} \frac{d}{dt} \left( \int_{r_{is}}^{\infty} m(r) n(r) dr \right) =
  \left. \frac{1}{\rho} \frac{dr}{dt} \right|_{r=r_{is}} m(r_{is}) n(r_{is}) + \frac{1}{\rho} \int_{r_{is}}^{\infty} \frac{dm}{dt} n(r) dr
\end{equation}\]</div><p>The <span>$\frac{dm}{dt}$</span> is obtained by solving the water vapor diffusion equation in spherical coordinates and linking the changes in temperature at the drop surface to the changes in saturated vapor pressure via the Clausius- Clapeyron equation, following <a href="https://global.oup.com/academic/product/the-physics-of-clouds-9780199588046?cc=us&amp;lang=en&amp;">Mason_1971</a>.</p><p>For the simplest case of spherical particles and not taking into account ventilation effects:</p><div>\[\begin{equation}
\frac{dm}{dt} = 4 \pi \, r \, (S - 1) \, G(T, p)
\label{eq:mass_rate}
\end{equation}\]</div><p>where:</p><ul><li><span>$S(q_{vap}, q_{vap}^{sat}) = \frac{q_{vap}}{q_{vap}^{sat}} - 1$</span> is commonly labeled as supersaturation,</li><li><span>$q_{vap}^{sat}$</span> is the saturation vapor specific humidity,</li><li><span>$G(T) = \left(\frac{L_s}{KT} \left(\frac{L_s}{R_v T} - 1 \right) + \frac{R_v T}{p_{vap}^{sat} D} \right)^{-1}$</span>   combines the effects of thermal conductivity and water diffusivity.</li><li><span>$L_s$</span> is the latent heat of sublimation,</li><li><span>$K_{thermo}$</span> is the thermal conductivity of air,</li><li><span>$R_v$</span> is the gas constant of water vapor,</li><li><span>$D_{vapor}$</span> is the diffusivity of water vapor</li></ul><p>Using eq. (\ref{eq:mass_rate}) and the assumed mass-radius relationship we obtain</p><div>\[\begin{equation}
\frac{dr}{dt} = \frac{4 \pi \, (S - 1) \, G(T, p)}{\alpha^{ice} \beta^{ice}} r^{2-\beta^{ice}}
\label{eq:r_rate}
\end{equation}\]</div><p>Finally the snow autoconversion rate is computed as</p><div>\[\begin{equation}
  \left. \frac{d \, q_{sno}}{dt} \right|_{acnv} =
   \frac{1}{\rho} 4 \pi \, (S-1) \, G(T,p) \, n_0^{ice} \, exp(-\lambda_{ice} r_{is})
   \left( \frac{r_{is}^2}{\beta^{ice}} + \frac{r_{is} \lambda_{ice} +1}{\lambda_{ice}^2} \right)
\end{equation}\]</div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We should include ventialtion effects.</p><p>For non-spherical particles the mass rate of growth should be multiplied by a function depending on the particle aspect ratio. For functions proposed for different crystal habitats see <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0469%281995%29052%3C4344%3APOICCP%3E2.0.CO%3B2">Harrington_1995</a> Appentix B.</p></div></div><h3 id="Accretion-1"><a class="docs-heading-anchor" href="#Accretion-1">Accretion</a><a class="docs-heading-anchor-permalink" href="#Accretion-1" title="Permalink"></a></h3><p>Accretion defines the rates of conversion between different categories due to collisions between particles.</p><p>For the case of collisions bewteen suspended water (cloud water or cloud ice) and falling water (rain or snow) the sink of suspended water is defined as:</p><div>\[\begin{equation}
\left. \frac{d \, q_{s}}{dt} \right|_{accr} =  - \int_0^\infty n_f(r) \, a_f(r) \, v_{term}(r) E_{sf} q_{s} dr
\label{eq:accr_1}
\end{equation}\]</div><p>where:</p><ul><li><span>$s$</span> subscript indicates suspended water category (cloud water or cloud ice)</li><li><span>$f$</span> subscript indicates falling water category (rain or snow)</li><li><span>$E_{sf}$</span> is the collision efficiency.</li></ul><p>Integrating over the distribution yeilds:</p><div>\[\begin{equation}
\left. \frac{d \, q_s}{dt} \right|_{accr} =
  - n_{0f} \, \zeta_f \, \gamma_f \, q_s \, E_{sf} \, \frac{\Gamma(\eta_f + \delta_f + 1)}{\lambda_f^{\eta_f + \delta_f +1}}
\label{eq:accrfin}
\end{equation}\]</div><p>For the case of cloud water - rain, cloud ice  - snow collisions the sink of suspended water becomes simply the source for falling water. For the case of cloud water and snow collisions for temperatures below freezing the sink of cloud water is a source for snow. For temperatures above freezing the accreted cloud droplets along with some melted snow are converted to rain. In this case eq. (\ref{eq:accrfin}) describes the sink of cloud water. The sink of snow is proportional to the sink of cloud water with the coefficient <span>$\frac{c_w}{L_f}(T - T_{freeze})$</span>.</p><p>The collisions between cloud ice - rain create snow. The source of snow in this case is a sum of sinks from cloud ice and rain. The sink of cloud ice is defined by eq. (\ref{eq:accrfin}). The sink of rain is defined as:</p><div>\[\begin{equation}
\left. \frac{d \, q_{rai}}{dt} \right|_{accr\_ri} =
  - \int_0^\infty \int_0^\infty
  \frac{1}{\rho} \, E_{ir} \, n_i(r_i) \, n_r(r_r) \, a_r(r_r) \, m_r(r_r)  \, v_{term}(r_r) \, d r_i d r_r
\label{eq:accr_ir}
\end{equation}\]</div><p>where:</p><ul><li><span>$E_{ir}$</span> is the collision efficiency between rain and cloud ice</li><li><span>$n_i$</span> and <span>$n_r$</span> are the cloud ice and rain size distributions</li><li><span>$m_r$</span>, <span>$a_r$</span> and <span>$v_{term}$</span> are the mass(radius), cross section(radius) and terminal velocity(radius) relations for rain</li><li><span>$r_i$</span> and <span>$r_r$</span> mark integration over cloud ice and rain size distributions</li></ul><p>Integrating eq.(\ref{eq:accr_ir}) yelds:</p><div>\[\begin{equation}
\left. \frac{d \, q_{rai}}{dt} \right|_{accr\_ri} =
  - E_{ir} \, n_0^{rai} \, n_0^{ice} \, \alpha^{rai} \, \gamma^{rai} \, \zeta^{rai} \frac{1}{\lambda_{ice}}
  \frac{\Gamma(\beta^{rai} + \delta^{rai} + \eta^{rai} +1)}{\lambda_{rai}^{(\beta^{rai} + \delta^{rai} + \eta^{rai} + 1)}}
\end{equation}\]</div><p>Collisions between rain and snow result in snow in temperatures below freezing andin rain in temperatures above freezing. The source term is defined as:</p><div>\[\begin{equation}
\left. \frac{d \, q_i}{dt} \right|_{accr} =
    \int_0^\infty \int_0^\infty
    n_i(r_i) \, n_j(r_j) \, a(r_i, r_j) \, m_j(r_j) \, E_{ij} \, \left|v_{term}(r_i) - v_{term}(r_j)\right| \, dr_i dr_j
\label{eq:accr_sr1}
\end{equation}\]</div><p>where</p><ul><li><span>$i$</span> stands for rain (<span>$T&gt;T_{freezing}$</span>) or snow (<span>$T&lt;T_{freezing}$</span>)</li><li><span>$j$</span> stands for snow (<span>$T&gt;T_{freezing}$</span>) or rain (<span>$T&lt;T_{freezing}$</span>)</li><li><span>$a(r_i, r_j)$</span> is the crossection of the two colliding particles</li></ul><p>There are two additional assuptions that we make to integrate eq.(\ref{eq:accr_sr1}):</p><ul><li><p><span>$\left|v_{term}(r_i) - v_{term}(r_j)\right| \approx \left| v_{ti} - v_{tj} \right|$</span> We approximate the teminal velocity difference for each particle pair with a difference between mass-weighted mean terminal velocityes and move it outside of the integral. See the discussion in <a href="https://www.mri-jma.go.jp/Publish/Technical/DATA/VOL_28/28_005.pdf">Ikawa_and_Saito_1991</a> page 88.</p></li><li><p>We assume that <span>$a(r_i, r_j) = \pi (r_i + r_j)^2$</span>.  This corresponds to a geometric formulation of the collision kernel, aka cylindrical fomulation,  see <a href="https://journals.ametsoc.org/doi/pdf/10.1175/JAS3655.1">Wang_et_al_2005</a> for discussion.</p></li></ul><p>The eq.(\ref{eq:accr_sr1}) can then be integrated as:</p><div>\[\begin{align}
\left. \frac{d \, q_i}{dt} \right|_{accr} &amp; =
    \pi \, n_0^{i} \, n_0^{j} \, \alpha_j \, E_{ij} \left| v_{ti} - v_{tj} \right|
    \int_0^\infty \int_0^\infty
    (r_i + r_j)^2
    r_{j}^{\beta_j} \,
    exp(- \lambda_j r_j) \,
    exp(- \lambda_i r_i) \,
    dr_i dr_j \\
    &amp; =
    \pi \, n_0^{i} \, n_0^{j} \, \alpha_j \, E_{ij} \left| v_{ti} - v_{tj} \right|
    \left(
        \frac{2 \Gamma(\beta_j + 1)}{\lambda_i^3 \lambda_j^{\beta_j+1}}
        + \frac{2 \Gamma(\beta_j + 2)}{ \lambda_i^2 \lambda_j^{\beta_j+2}}
        + \frac{\Gamma(\beta_j + 3)}{\lambda_i \lambda_j^{\beta_j + 3}}
    \right)
\end{align}\]</div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Both of the assumptions needed to integrate the snow-rain accretion rate could be revisited:</p><p>The discussion on page 88 in <a href="https://www.mri-jma.go.jp/Publish/Technical/DATA/VOL_28/28_005.pdf">Ikawa_and_Saito_1991</a> suggests an alternative approximation of the velocity difference.</p><p>The <span>$(r_i + r_j)^2$</span> assumption for the crossection is inconsistent with the snow crossection used when modelling collisions with cloud water and cloud ice.</p></div></div><h3 id="Rain-evaporation-and-snow-sublimation-1"><a class="docs-heading-anchor" href="#Rain-evaporation-and-snow-sublimation-1">Rain evaporation and snow sublimation</a><a class="docs-heading-anchor-permalink" href="#Rain-evaporation-and-snow-sublimation-1" title="Permalink"></a></h3><p>We start from a similar equation as when computing snow autoconversion rate but integrate it from <span>$0$</span> to <span>$\infty$</span>.</p><div>\[\begin{equation}
  \left. \frac{dq}{dt} \right|_{evap\_subl} = \frac{1}{\rho} \int_{0}^{\infty} \frac{dm(r)}{dt} n(r) dr
\end{equation}\]</div><p>In contrast to eq.(\ref{eq:mass_rate}), now we are taking into account ventilation effects:</p><div>\[\begin{equation}
  \frac{dm}{dt} = 4 \pi \, r \, (S - 1) \, G(T) \, F(r)
\label{eq:mass_rate2}
\end{equation}\]</div><p>where:</p><ul><li><span>$F(r)$</span> is the rain drop ventilation factor defined in (\ref{eq:ventil_factor})</li><li>supersaturation S is computed over water or ice</li><li><span>$L$</span> is the latent heat of vaporization or sublimation.</li></ul><p>The final integral is:</p><div>\[\begin{align}
\left. \frac{dq}{dt} \right|_{evap\_subl} &amp; =
    \frac{4 \pi n_0}{\rho} (S - 1) G(T)
    \int_0^\infty
    \left(
       a_{vent} \, r +
       b_{vent} \left( \frac{\nu_{air}}{D_{vapor}} \right)^{\frac{1}{3}}
         \left( \frac{2 \zeta}{\nu_{air}} \right)^{\frac{1}{2}} r^{\frac{\eta + 3}{2}}
    \right)
    exp(-\lambda r) dr \\
    &amp; =
    \frac{4 \pi n_0}{\rho} (S - 1) G(T) \lambda^{-2}
    \left(
       a_{vent} +
       b_{vent} \left( \frac{\nu_{air}}{D_{vapor}} \right)^{\frac{1}{3}}
         \left( \frac{2 \zeta}{\nu_{air}} \right)^{\frac{1}{2}}
         \Gamma \left( \frac{\eta + 5}{2} \right) \lambda^{- \frac{\eta +1}{2}}
    \right)
\end{align}\]</div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We should take into account the non-spherical snow shape. - Modify the Reynolds number and growth equation.</p></div></div><h3 id="Snow-melt-1"><a class="docs-heading-anchor" href="#Snow-melt-1">Snow melt</a><a class="docs-heading-anchor-permalink" href="#Snow-melt-1" title="Permalink"></a></h3><p>If snow occurs in temperatures above freezing it is melting into rain. The sink for snow is parameterized again as</p><div>\[\begin{equation}
  \left. \frac{dq}{dt} \right|_{melt} = \frac{1}{\rho} \int_{0}^{\infty} \frac{dm(r)}{dt} n(r) dr
\end{equation}\]</div><p>For snow melt</p><div>\[\begin{equation}
  \frac{dm}{dt} = 4 \pi \, r \, \frac{K_{thermo}}{L_f} (T - T_{freeze}) \, F(r)
\label{eq:mass_rate3}
\end{equation}\]</div><p>where:</p><ul><li><span>$F(r)$</span> is the ventilation factor defined in (\ref{eq:ventil_factor})</li><li><span>$L_f$</span> is the latent heat of freezing.</li></ul><div>\[\begin{equation}
\left. \frac{dq}{dt} \right|_{evap\_subl} =
    \frac{4 \pi \, n_0 \, K_{thermo}}{\rho \, L_f} (T - T_{freeze}) \lambda^{-2}
    \left(
       a_{vent} +
       b_{vent} \left( \frac{\nu_{air}}{D_{vapor}} \right)^{\frac{1}{3}}
         \left( \frac{2 \zeta}{\nu_{air}} \right)^{\frac{1}{2}}
         \Gamma \left( \frac{\eta + 5}{2} \right) \lambda^{- \frac{\eta +1}{2}}
    \right)
\end{equation}\]</div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Model/risingbubble/">« Rising Bubble LES</a><a class="docs-footer-nextpage" href="../Model/turbulence/">Turbulence »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 8 May 2020 06:31">Friday 8 May 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
